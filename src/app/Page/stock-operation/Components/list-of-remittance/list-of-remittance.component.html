<mat-card class="section-container ">
  <div fxLayout="column">
    <div fxLayout="row" fxLayoutAlign="center center">
      <p class="mat-h2 modal-title">فهرست حواله ها</p>
    </div>
    <div fxLayout="row" fxFill>
      <div *ngIf="isLoading$ | async; else table" fxLayout="column" fxLayoutAlign="center center">
        <div class="loading-shade" *ngIf="isLoading$ | async">
          <div fxLayout="column" fxLayoutAlign="center center">
            <mat-progress-spinner [strokeWidth]="3" [diameter]="30" [mode]="'indeterminate'" *ngIf="isLoading$ | async">
            </mat-progress-spinner>
            <h3 class="mt-3">در حال دریافت اطلاعت از سرور ...</h3>
          </div>
        </div>
      </div>

    </div>
    <ng-template #table>
      <div fxLayout="column" fxFlex="100%">
        <div class="remitt-list_header" fxLayout="row" fxFill *ngIf="false">
          <div class="devices-list_header_action-btn" fxFlexAlign="center center">
            <button mat-icon-button matTooltipClass="tooltip-style" matTooltip="جستجوی"
              (click)="toggleFilters = !toggleFilters" matTooltipPosition="right">
              <div *ngIf="toggleFilters;else close">
                <mat-icon>search</mat-icon>
              </div>
              <ng-template #close>
                <mat-icon>search_off</mat-icon>
              </ng-template>
              <!-- search_off -->
            </button>
          </div>
          <div fxLayout="row" fxLayoutGap="15px" fxFlexAlign="center center" class="search-box w-100"
            *ngIf="!toggleFilters">
            <div fxLayout="row" fxFlexAlign="space-between">
              <div fxLayout="row" [ngSwitch]="searchControl" fxLayoutGap="15px">
                <div *ngSwitchCase="search_control.isDropDownShow">
                  <mat-form-field appearance="outline" style="margin-left: 10px; width: 145px; font-size: 10px;">
                    <mat-label>وضعیت تردد</mat-label>
                    <mat-select>
                      <mat-option value="option1">Option 1</mat-option>
                      <mat-option value="option2">Option 2 </mat-option>
                      <mat-option value="option3">Option 3</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <div *ngSwitchCase="search_control.isTextBoxShow">
                  <mat-form-field appearance="standard">
                    <mat-label>Filter</mat-label>
                    <input matInput (keyup)="applyFilter($event)" placeholder="Ex. ium" #input>
                  </mat-form-field>
                </div>
                <div *ngSwitchCase="search_control.isDateBoxShow">
                  <mat-form-field class=" input-size" appearance="outline" color="primary">
                    <mat-label>تاریخ</mat-label>
                    <input matInput [matDatepicker]="picker" placeholder="تاریخ شروع قرارداد" r readonly>
                    <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                    <mat-datepicker #picker>
                      <mat-datepicker-actions>
                        <button mat-button matDatepickerCancel>انصراف</button>
                        <button mat-raised-button color="primary" matDatepickerApply>تایید</button>
                      </mat-datepicker-actions>
                    </mat-datepicker>

                  </mat-form-field>
                </div>
                <div *ngIf="isSearchButonShow" fxFlexAlign="center center">
                  <button mat-flat-button mat-Stroked-button color="primary">
                    <span color="primary">جستجو</span>
                  </button>
                </div>

              </div>
              <div fxLayout="row" fxLayoutGap="12px">
                <mat-radio-group class="radio-btns" [(ngModel)]="searchType" (change)="radioChange($event)">
                  <mat-radio-button value="all" checked="true">همه</mat-radio-button>
                  <mat-radio-button value="id">کدحواله</mat-radio-button>
                  <mat-radio-button value="bachNumber">شماره بچ</mat-radio-button>
                  <mat-radio-button value="personName">مشتری</mat-radio-button>
                  <mat-radio-button value="stockName">انبار</mat-radio-button>
                  <mat-radio-button value="remittenceType">نوع حواله</mat-radio-button>
                  <mat-radio-button value="date">تاریخ</mat-radio-button>
                </mat-radio-group>
              </div>
            </div>
          </div>

        </div>
        <!-- @blub -->
        <div class="table-containers">
          <!-- [@listAnimation]="dataSource.data.length" -->
          <table mat-table [dataSource]="dataSource" class="w-100 text-right table-width "
            [ngClass]="dataSource.data.length == 0 ? 'table-fullHeights' : ''">

            <!-- Index Column -->
            <ng-container matColumnDef="index">
              <th class="text-center" mat-header-cell *matHeaderCellDef class="index-col-width">ردیف</th>
              <td class="text-center mat-column-small-width" mat-cell *matCellDef="let element;index as i;">
                {{i+1}}
              </td>
            </ng-container>
            <!-- id Column -->
            <ng-container matColumnDef="id">
              <th mat-header-cell *matHeaderCellDef class="id-col-width text-right">
                کدحواله
              </th>
              <td mat-cell *matCellDef="let element" class="text-right"> {{element.id}}</td>
            </ng-container>
            <!-- manuelId Column -->
            <ng-container matColumnDef="manuelId">
              <th mat-header-cell *matHeaderCellDef class="manuelid-col-width text-right">
                 کددستی حواله
              </th>
              <td mat-cell *matCellDef="let element" class="text-right "><span class="manuelid_data_color">{{element.manuelId}}</span> </td>
            </ng-container>
            <!-- personName Column -->
            <ng-container matColumnDef="personName">
              <th mat-header-cell *matHeaderCellDef class="name-col-width text-right">مشتری</th>
              <td mat-cell *matCellDef="let element" class="text-right">{{element.personName}} </td>
            </ng-container>
            <!-- stockName Column -->
            <ng-container matColumnDef="stockName">
              <th mat-header-cell *matHeaderCellDef class="stock-col-width text-right">انبار</th>
              <td mat-cell *matCellDef="let element" class="text-right">{{element.stockName}} </td>
            </ng-container>
            <!-- remittenceType Column -->
            <ng-container matColumnDef="remittenceType">
              <th mat-header-cell *matHeaderCellDef class="remittancetype-col-width text-right">نوع حواله</th>
              <td mat-cell *matCellDef="let element" class="text-right"> {{getOperationType(element.stockOperationType)}} </td>
            </ng-container>
            <!-- date Column -->
            <ng-container matColumnDef="date">
              <th mat-header-cell *matHeaderCellDef class="date-col-width text-right">تاریخ تنظیم</th>
              <td mat-cell *matCellDef="let element" class="text-right"> {{getShamsi(element.registerDate)}} </td>
            </ng-container>
            <!-- refId Column -->
            <ng-container matColumnDef="refId">
              <th mat-header-cell *matHeaderCellDef class="date-col-width text-right">سند مبنا</th>
              <td mat-cell *matCellDef="let element" class="text-right">
                <div *ngIf="element.refId!=0">
                  {{element.refId}}
                </div>
              </td>
            </ng-container>
            <!-- desc Column -->
            <ng-container matColumnDef="desc">
              <th mat-header-cell *matHeaderCellDef class="dec-col-width text-right">توضیحات</th>
              <td mat-cell *matCellDef="let element" class="text-right"> {{element.description}} </td>
            </ng-container>
            <!-- Delete -->
            <ng-container matColumnDef="menu">
              <th mat-header-cell class="text-center" *matHeaderCellDef></th>
              <td mat-cell *matCellDef="let element" class="mat-column-small-width text-left">
                <button mat-icon-button [matMenuTriggerFor]="menu" [matMenuTriggerData]="{element: element}">
                  <i class="icon-more-vertical icon-20px"></i>
                </button>
              </td>
              <!-- <td mat-cell class="mat-column-small-width text-left menu-width" *matCellDef="let row">
     
                <div  [hidden]="row.id != currentRow">
                  <button mat-icon-button matTooltip="نمایش جزییات" matTooltipPosition="right" (click)="getDetails(row)">
                    <i class="icon-eye icon-20px "></i>
                  </button>
                  <button mat-icon-button (click)="delete(row)" matTooltip="خذف" matTooltipPosition="above">
                    <i class="icon-trash-2 icon-20px delete-btn" ></i>
                  </button>
  
                </div>
              </td> -->
            </ng-container>


            <tr mat-header-row *matHeaderRowDef="displayedColumns;sticky: true" class="table-header-color">
            </tr>
            <tr class="mat-row" *matNoDataRow>
              <td class="mat-cell" [colSpan]="displayedColumns.length+1">
                <div fxLayout="row" fxFill fxLayoutAlign="center center">
                  <div class="warning-box">
                    <span>اطلاعاتی جهت نمایش وجود ندارد</span>
                  </div>

                </div>
              </td>
            </tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;;sticky: true" [ngClass]="{hovered: row.hovered}"
              (mouseover)="row.hovered = true" (mouseover)="currentRow = row.id" (mouseout)="currentRow= -1"
              (mouseout)="row.hovered = false">
            </tr>
          </table>

        </div>
        <mat-menu #menu="matMenu">
          <ng-template matMenuContent let-aliasMenuItems="element">
            <button mat-menu-item (click)="getDetails(aliasMenuItems)">
              <div fxLayout="row" fxLayoutGap="10px" fxLayoutAlign="start center">
                <i class="icon-file-text icon-20px ms-2"></i>
                <span>جزئیات حواله</span>
              </div>
            </button>
            <button mat-menu-item (click)="edit(aliasMenuItems)">
              <div fxLayout="row" fxLayoutGap="10px" fxLayoutAlign="start center">
                <i class="icon-edit-3 icon-20px ms-2"></i>
                <span>ویرایش</span>
              </div>
            </button>
            <button mat-menu-item (click)="editManuelId(aliasMenuItems)">
              <div fxLayout="row" fxLayoutGap="10px" fxLayoutAlign="start center">
                <i class="icon-edit icon-20px ms-2"></i>
                <span>ویرایش کد دستی سند</span>
              </div>
            </button>
            <button mat-menu-item (click)="delete(aliasMenuItems)">
              <div fxLayout="row" fxLayoutGap="10px" fxLayoutAlign="start center">
                <i class="icon-trash icon-20px "></i>
                <span>حذف </span>
              </div>
            </button>
          </ng-template>
        </mat-menu>
        <!-- <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons #paginator
            aria-label="Select page of periodic elements">
          </mat-paginator> -->
      </div>
    </ng-template>
  </div>

</mat-card>
